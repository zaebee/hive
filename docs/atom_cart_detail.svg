<?xml version="1.0" encoding="UTF-8"?>
<svg width="600" height="400" xmlns="http://www.w3.org/2000/svg" font-family="'Fira Code', monospace">
  <defs>
    <radialGradient id="aggregateGradient" cx="0.5" cy="0.5" r="0.5">
      <stop offset="0%" stop-color="#fff9e6"/>
      <stop offset="100%" stop-color="#f39c12"/>
    </radialGradient>
    <radialGradient id="connectorGradient" cx="0.5" cy="0.5" r="0.5">
      <stop offset="0%" stop-color="#eaf2f8"/>
      <stop offset="100%" stop-color="#3498db"/>
    </radialGradient>
    <radialGradient id="eventGradient" cx="0.5" cy="0.5" r="0.5">
      <stop offset="0%" stop-color="#e8f8f5"/>
      <stop offset="100%" stop-color="#2ecc71"/>
    </radialGradient>
    <filter id="shadow" x="-50%" y="-50%" width="200%" height="200%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-color="rgba(0,0,0,0.2)"/>
    </filter>
    <style>
      .background { fill: #f8f9f9; }
      .aggregate { fill: url(#aggregateGradient); stroke: #c07210; }
      .connector { fill: url(#connectorGradient); stroke: #2874a6; }
      .event { fill: url(#eventGradient); stroke: #239b56; }
      .nucleus, .port, .particle { stroke-width: 2; filter: url(#shadow); }
      .flow-arrow { stroke: #566573; stroke-width: 2.5; marker-end: url(#arrowhead); animation: flow 2s infinite linear; }
      .label { text-anchor: middle; font-size: 14px; font-weight: bold; fill: #2c3e50; }
      .small-label { text-anchor: middle; font-size: 11px; fill: #566573; }
      @keyframes flow { from { stroke-dashoffset: 20; } to { stroke-dashoffset: 0; } }
    </style>
    <marker id="arrowhead" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#566573" />
    </marker>
  </defs>

  <rect width="600" height="400" class="background" rx="10"/>

  <text x="300" y="40" class="label" font-size="18px">Субатомная Структура: Атом "Cart"</text>

  <!-- C (Connector) -> A (Aggregate) -> G (Genesis Event) -->

  <!-- 1. Connector Port (Input) -->
  <g transform="translate(100, 200)">
    <rect x="-50" y="-30" width="100" height="60" rx="10" class="port connector"/>
    <text y="5" class="label">C</text>
    <text y="25" class="small-label">CartAPI_Handler</text>
  </g>

  <!-- 2. Aggregate Nucleus (Processing) -->
  <g transform="translate(300, 200)">
    <circle cx="0" cy="0" r="60" class="nucleus aggregate"/>
    <text y="-5" class="label">A</text>
    <text y="15" class="small-label">CartAggregate</text>
  </g>

  <!-- 3. Genesis Event Particle (Output) -->
  <g transform="translate(500, 200)">
    <circle cx="0" cy="0" r="35" class="particle event"/>
    <text y="0" class="label">G</text>
    <text y="18" class="small-label">CartCheckedOut</text>
  </g>

  <!-- Flow Arrows -->
  <path d="M 150 200 L 240 200" class="flow-arrow" stroke-dasharray="10, 10" fill="none"/>
  <path d="M 360 200 L 465 200" class="flow-arrow" stroke-dasharray="10, 10" fill="none"/>

</svg>
